

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>17. Page Templates &mdash; Mastering Plone 1.2.5a documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
        <link rel="author" title="About these documents"
              href="about.html"/>
    <link rel="top" title="Mastering Plone 1.2.5a documentation" href="index.html"/>
        <link rel="next" title="18. Customizing Existing Templates" href="zpt_2.html"/>
        <link rel="prev" title="16. Views I" href="views_1.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Mastering Plone
          

          
          </a>

          
            
            
              <div class="version">
                1.2.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">About Mastering Plone</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">2. Installation &amp; Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="plone_training_config/instructions.html">3. Installing Plone for the Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="anatomy.html">4. The Anatomy of Plone</a></li>
<li class="toctree-l1"><a class="reference internal" href="case.html">5. The Case Study</a></li>
<li class="toctree-l1"><a class="reference internal" href="features.html">6. The Features of Plone</a></li>
<li class="toctree-l1"><a class="reference internal" href="plone5.html">7. What&#8217;s New in Plone 5</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuring_customizing.html">8. Configuring and Customizing Plone &#8220;Through The Web&#8221;</a></li>
<li class="toctree-l1"><a class="reference internal" href="extending.html">9. Extending Plone</a></li>
<li class="toctree-l1"><a class="reference internal" href="add-ons.html">10. Extend Plone With Add-On Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="theming/index.html">11. Mastering Plone 5: Theming</a></li>
<li class="toctree-l1"><a class="reference internal" href="javascript/index.html">JavaScript for Plone Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="dexterity.html">12. Dexterity I: &#8220;Through The Web&#8221;</a></li>
<li class="toctree-l1"><a class="reference internal" href="buildout_1.html">13. Buildout I</a></li>
<li class="toctree-l1"><a class="reference internal" href="eggs1.html">14. Write Your Own Add-Ons to Customize Plone</a></li>
<li class="toctree-l1"><a class="reference internal" href="export_code.html">15. Return to Dexterity: Moving contenttypes into Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="views_1.html">16. Views I</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">17. Page Templates</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#tal-and-tales">TAL and TALES</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#python-expressions">python expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tal-condition">tal:condition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tal-repeat">tal:repeat</a></li>
<li class="toctree-l3"><a class="reference internal" href="#path-expressions">path expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pure-tal-blocks">Pure TAL blocks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#handling-complex-data-in-templates">handling complex data in templates</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#plone-5">Plone 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="#exercise-1">Exercise 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="#metal-and-macros">METAL and macros</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#macros-in-browser-views">macros in browser views</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#accessing-plone-from-the-template">Accessing Plone from the template</a></li>
<li class="toctree-l2"><a class="reference internal" href="#what-we-missed">What we missed</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tal-chameleon-label">Chameleon</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="zpt_2.html">18. Customizing Existing Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="views_2.html">19. Views II: A Default View for &#8220;Talk&#8221;</a></li>
<li class="toctree-l1"><a class="reference internal" href="views_3.html">20. Views III: A Talk List</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">21. Testing in Plone</a></li>
<li class="toctree-l1"><a class="reference internal" href="behaviors_1.html">22. Behaviors</a></li>
<li class="toctree-l1"><a class="reference internal" href="viewlets_1.html">23. Writing Viewlets</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">24. Programming Plone</a></li>
<li class="toctree-l1"><a class="reference internal" href="ide.html">25. IDEs and Editors</a></li>
<li class="toctree-l1"><a class="reference internal" href="dexterity_2.html">26. Dexterity Types II: Growing Up</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_search.html">27. Custom Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="events.html">28. Turning Talks into Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_generated_content.html">29. User Generated Content</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">30. Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="thirdparty_behaviors.html">31. Using Third-Party Behaviors</a></li>
<li class="toctree-l1"><a class="reference internal" href="dexterity_3.html">32. Dexterity Types III: Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="relations.html">33. Relations</a></li>
<li class="toctree-l1"><a class="reference internal" href="registry.html">34. Storing Settings in the Registry and create control-panels</a></li>
<li class="toctree-l1"><a class="reference internal" href="eggs2.html">35. Creating Reusable Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="behaviors_2.html">36. More Complex Behaviors</a></li>
<li class="toctree-l1"><a class="reference internal" href="viewlets_2.html">37. A Viewlet for the Votable Behavior</a></li>
<li class="toctree-l1"><a class="reference internal" href="reusable.html">38. Making Our Package Reusable</a></li>
<li class="toctree-l1"><a class="reference internal" href="embed.html">39. Using starzel.votable_behavior in ploneconf.site</a></li>
<li class="toctree-l1"><a class="reference internal" href="deployment_code.html">40. Releasing Your Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="deployment_sites.html">41. Buildout II: Getting Ready for Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="frontpage.html">42. Creating a Dynamic Front Page</a></li>
<li class="toctree-l1"><a class="reference internal" href="future_of_plone.html">43. The Future of Plone</a></li>
<li class="toctree-l1"><a class="reference internal" href="optional.html">44. Optional</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="CHANGES.html">Changelog</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Mastering Plone</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>17. Page Templates</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="page-templates">
<span id="zpt-label"></span><h1>17. Page Templates<a class="headerlink" href="#page-templates" title="Permalink to this headline">¶</a></h1>
<div class="sidebar">
<p class="first sidebar-title">Get the code!</p>
<p>Get the code for this chapter (<a class="reference internal" href="sneak.html"><em>More info</em></a>) using this command in the buildout directory:</p>
<div class="last highlight-bash"><div class="highlight"><pre>cp -R src/ploneconf.site_sneak/chapters/03_zpt_p5/ src/ploneconf.site
</pre></div>
</div>
</div>
<p>In this part you will:</p>
<ul class="simple">
<li>Learn to write page templates</li>
</ul>
<p>Topics covered:</p>
<ul class="simple">
<li>TAL and TALES</li>
<li>METAL</li>
<li>Chameleon</li>
</ul>
<p>Page Templates are HTML files with some additional information, written in TAL, METAL and TALES.</p>
<p>Page templates must be valid xml.</p>
<p>The three languages are:</p>
<ul class="simple">
<li>TAL: &#8220;Template Attribute Language&#8221;<ul>
<li>Templating XML/HTML using special attributes</li>
<li>Using TAL we include expressions within html</li>
</ul>
</li>
<li>TALES: &#8220;TAL Expression Syntax&#8221;<ul>
<li>defines the syntax and semantics of these expressions</li>
</ul>
</li>
<li>METAL: &#8220;Macro Expansion for TAL&#8221;<ul>
<li>this enables us to combine, re-use and nest templates together</li>
</ul>
</li>
</ul>
<p>TAL and METAL are written like html attributes (href, src, title). TALES are written like the values of html attributes. A typical TAL attribute looks like this:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;title</span> <span class="na">tal:content=</span><span class="s">&quot;context/title&quot;</span><span class="nt">&gt;</span>
    The Title of the content
<span class="nt">&lt;/title&gt;</span>
</pre></div>
</div>
<p>It&#8217;s used to modify the output:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;p</span> <span class="na">tal:content=</span><span class="s">&quot;string:I love red&quot;</span><span class="nt">&gt;</span>I love blue<span class="nt">&lt;/p&gt;</span>
</pre></div>
</div>
<p>results in:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;p&gt;</span>I love red<span class="nt">&lt;/p&gt;</span>
</pre></div>
</div>
<p>Let&#8217;s try it. Open the file <code class="docutils literal"><span class="pre">training.pt</span></code> and add:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;body&gt;</span>

    <span class="nt">&lt;p&gt;</span>red<span class="nt">&lt;/p&gt;</span>

<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</div>
<div class="section" id="tal-and-tales">
<span id="zpt-tal-label"></span><h2>TAL and TALES<a class="headerlink" href="#tal-and-tales" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s add some magic and modify the &lt;p&gt;-tag:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;p</span> <span class="na">tal:content=</span><span class="s">&quot;string:blue&quot;</span><span class="nt">&gt;</span>red<span class="nt">&lt;/p&gt;</span>
</pre></div>
</div>
<p>This will result in:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;p&gt;</span>blue<span class="nt">&lt;/p&gt;</span>
</pre></div>
</div>
<p>Without restarting Plone open <a class="reference external" href="http://localhost:8080/Plone/&#64;&#64;training">http://localhost:8080/Plone/&#64;&#64;training</a>.</p>
<p>The same happens with attributes. Replace the &lt;p&gt;-line with:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://www.mssharepointconference.com&quot;</span>
   <span class="na">tal:define=</span><span class="s">&quot;a_fine_url string:http://www.ploneconf.org&quot;</span>
   <span class="na">tal:attributes=</span><span class="s">&quot;href a_fine_url&quot;</span>
   <span class="na">tal:content=</span><span class="s">&quot;string:An even better conference&quot;</span><span class="nt">&gt;</span>
    A sharepoint conference
<span class="nt">&lt;/a&gt;</span>
</pre></div>
</div>
<p>results in:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://www.ploneconf.org&quot;</span><span class="nt">&gt;</span>
    An even better conference
<span class="nt">&lt;/a&gt;</span>
</pre></div>
</div>
<p>We used three TAL-Attributes here. This is the complete list of TAL-attributes:</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">tal:define</span></code></dt>
<dd>define variables. We defined the variable <code class="docutils literal"><span class="pre">a_fine_url</span></code> to the string &#8220;<a class="reference external" href="http://www.ploneconf.org">http://www.ploneconf.org</a>&#8220;</dd>
<dt><code class="docutils literal"><span class="pre">tal:content</span></code></dt>
<dd>replace the content of an element. We replaced the default content above with &#8220;An even better conference&#8221;</dd>
<dt><code class="docutils literal"><span class="pre">tal:attributes</span></code></dt>
<dd>dynamically change element attributes. We set the html attribute <code class="docutils literal"><span class="pre">href</span></code> to the value of the variable <code class="docutils literal"><span class="pre">a_fine_url</span></code></dd>
<dt><code class="docutils literal"><span class="pre">tal:condition</span></code></dt>
<dd>tests whether the expression is true or false, and outputs or omits the element accordingly.</dd>
<dt><code class="docutils literal"><span class="pre">tal:repeat</span></code></dt>
<dd>repeats an iterable element, in our case the list of talks.</dd>
<dt><code class="docutils literal"><span class="pre">tal:replace</span></code></dt>
<dd>replace the content of an element, like <code class="docutils literal"><span class="pre">tal:content</span></code> does, but removes the element only leaving the content.</dd>
<dt><code class="docutils literal"><span class="pre">tal:omit-tag</span></code></dt>
<dd>remove an element, leaving the content of the element.</dd>
<dt><code class="docutils literal"><span class="pre">tal:on-error</span></code></dt>
<dd>handle errors.</dd>
</dl>
<div class="section" id="python-expressions">
<h3>python expressions<a class="headerlink" href="#python-expressions" title="Permalink to this headline">¶</a></h3>
<p>So far we only used one TALES expression (the <code class="docutils literal"><span class="pre">string:</span></code> bit). Let&#8217;s use a different TALES expression now. With <code class="docutils literal"><span class="pre">python:</span></code> we can use python code. A simple example:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;p</span> <span class="na">tal:define=</span><span class="s">&quot;title context/title&quot;</span>
   <span class="na">tal:content=</span><span class="s">&quot;python:title.upper()&quot;</span><span class="nt">&gt;</span>
   A big title
<span class="nt">&lt;/p&gt;</span>
</pre></div>
</div>
<p>And another:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;p</span> <span class="na">tal:define=</span><span class="s">&quot;talks python:[&#39;Dexterity for the win!&#39;,</span>
<span class="s">                             &#39;Deco is the future&#39;,</span>
<span class="s">                             &#39;A keynote on some weird topic&#39;,</span>
<span class="s">                             &#39;The talk that I did not submit&#39;]&quot;</span>
   <span class="na">tal:content=</span><span class="s">&quot;python:talks[0]&quot;</span><span class="nt">&gt;</span>
    A talk
<span class="nt">&lt;/p&gt;</span>
</pre></div>
</div>
<p>With python expressions</p>
<ul class="simple">
<li>you can only write single statements</li>
<li>you could import things but you should not (example: <code class="docutils literal"><span class="pre">tal:define=&quot;something</span> <span class="pre">modules/Products.PythonScripts/something;</span></code>).</li>
</ul>
</div>
<div class="section" id="tal-condition">
<h3>tal:condition<a class="headerlink" href="#tal-condition" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">tal:condition</span></code></dt>
<dd>tests whether the expression is true or false.</dd>
</dl>
<ul class="simple">
<li>If it&#8217;s true, then the tag is rendered.</li>
<li>If it&#8217;s false then the tag <strong>and all its children</strong> are removed and no longer evaluated.</li>
<li>We can reverse the logic by prepending a <code class="docutils literal"><span class="pre">not:</span></code> to the expression.</li>
</ul>
<p>Let&#8217;s add another TAL Attribute to our above example:</p>
<div class="highlight-python"><div class="highlight"><pre>tal:condition=&quot;talks&quot;
</pre></div>
</div>
<p>We could also test for the number of talks:</p>
<div class="highlight-python"><div class="highlight"><pre>tal:condition=&quot;python:len(talks) &gt;= 1&quot;
</pre></div>
</div>
<p>or if a certain talk is in the list of talks:</p>
<div class="highlight-python"><div class="highlight"><pre>tal:condition=&quot;python:&#39;Deco is the future&#39; in talks&quot;
</pre></div>
</div>
</div>
<div class="section" id="tal-repeat">
<h3>tal:repeat<a class="headerlink" href="#tal-repeat" title="Permalink to this headline">¶</a></h3>
<p>Let&#8217;s try another attribute:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;p</span> <span class="na">tal:define=</span><span class="s">&quot;talks python:[&#39;Dexterity for the win!&#39;,</span>
<span class="s">                             &#39;Deco is the future&#39;,</span>
<span class="s">                             &#39;A keynote on some weird topic&#39;,</span>
<span class="s">                             &#39;The talk that I did not submit&#39;]&quot;</span>
   <span class="na">tal:repeat=</span><span class="s">&quot;talk talks&quot;</span>
   <span class="na">tal:content=</span><span class="s">&quot;talk&quot;</span><span class="nt">&gt;</span>
   A talk
<span class="nt">&lt;/p&gt;</span>
</pre></div>
</div>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">tal:repeat</span></code></dt>
<dd>repeats an iterable element, in our case the list of talks.</dd>
</dl>
<p>We change the markup a little to construct a list in which there is an <code class="docutils literal"><span class="pre">&lt;li&gt;</span></code> for every talk:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;ul</span> <span class="na">tal:define=</span><span class="s">&quot;talks python:[&#39;Dexterity for the win!&#39;,</span>
<span class="s">                              &#39;Deco is the future&#39;,</span>
<span class="s">                              &#39;A keynote on some weird topic&#39;,</span>
<span class="s">                              &#39;The talk that I did not submit&#39;]&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;li</span> <span class="na">tal:repeat=</span><span class="s">&quot;talk talks&quot;</span>
        <span class="na">tal:content=</span><span class="s">&quot;talk&quot;</span><span class="nt">&gt;</span>
          A talk
    <span class="nt">&lt;/li&gt;</span>
    <span class="nt">&lt;li</span> <span class="na">tal:condition=</span><span class="s">&quot;not:talks&quot;</span><span class="nt">&gt;</span>
          Sorry, no talks yet.
    <span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/ul&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="path-expressions">
<h3>path expressions<a class="headerlink" href="#path-expressions" title="Permalink to this headline">¶</a></h3>
<p>Regarding TALES so far we used <code class="docutils literal"><span class="pre">string:</span></code> or <code class="docutils literal"><span class="pre">python:</span></code> or only variables. The next and most common expression are path expressions. Optionally you can start a path expression with <code class="docutils literal"><span class="pre">path:</span></code></p>
<p>Every path expression starts with a variable name. It can either be an object like <code class="docutils literal"><span class="pre">context</span></code>, <code class="docutils literal"><span class="pre">view</span></code> or <code class="docutils literal"><span class="pre">template</span></code> or a variable defined earlier like <code class="docutils literal"><span class="pre">talk</span></code>.</p>
<p>After the variable we add a slash <code class="docutils literal"><span class="pre">/</span></code> and the name of a sub-object, attribute or callable. The &#8216;/&#8217; is used to end the name of an object and the start of the property name. Properties themselves may be objects that in turn have properties.</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;p</span> <span class="na">tal:content=</span><span class="s">&quot;context/title&quot;</span><span class="nt">&gt;&lt;/p&gt;</span>
</pre></div>
</div>
<p>We can chain several of those to get to the information we want.</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;p</span> <span class="na">tal:content=</span><span class="s">&quot;context/REQUEST/form&quot;</span><span class="nt">&gt;&lt;/p&gt;</span>
</pre></div>
</div>
<p>This would return the value of the form dictionary of the HTTPRequest object. Useful for form handling.</p>
<p>The <code class="docutils literal"><span class="pre">|</span></code> (&#8220;or&#8221;) character is used to find an alternative value to a path if the first path evaluates to <code class="docutils literal"><span class="pre">nothing</span></code> or does not exist.</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;p</span> <span class="na">tal:content=</span><span class="s">&quot;context/title | context/id&quot;</span><span class="nt">&gt;&lt;/p&gt;</span>
</pre></div>
</div>
<p>This returns the id of the context if it has no title.</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;p</span> <span class="na">tal:replace=</span><span class="s">&quot;talk/average_rating | nothing&quot;</span><span class="nt">&gt;&lt;/p&gt;</span>
</pre></div>
</div>
<p>This returns nothing if there is no &#8216;average_rating&#8217; for a talk. What will not work is <code class="docutils literal"><span class="pre">tal:content=&quot;python:talk['average_rating']</span> <span class="pre">or</span> <span class="pre">''&quot;</span></code>. Who knows what this would yield?</p>
<p>We&#8217;ll get <code class="docutils literal"><span class="pre">KeyError:</span> <span class="pre">'average_rating'</span></code>. It is very bad practice to use <code class="docutils literal"><span class="pre">|</span></code> too often since it will swallow errors like a typo in <code class="docutils literal"><span class="pre">tal:content=&quot;talk/averange_ratting</span> <span class="pre">|&nbsp;nothing&quot;</span></code> and you might wonder why there are no ratings later on...</p>
<p>You can&#8217;t and should not use it to prevent errors like a try/except block.</p>
<p>There are several <strong>built-in variables</strong>  that can be used in paths:</p>
<p>The most frequently used one is <code class="docutils literal"><span class="pre">nothing</span></code> which is the equivalent to None</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;p</span> <span class="na">tal:replace=</span><span class="s">&quot;nothing&quot;</span><span class="nt">&gt;</span>
    this comment will not be rendered
<span class="nt">&lt;/p&gt;</span>
</pre></div>
</div>
<p>A dict of all the available variables is <code class="docutils literal"><span class="pre">econtext</span></code></p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;dl</span> <span class="na">tal:define=</span><span class="s">&quot;path_variables_dict econtext&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;tal:vars</span> <span class="na">tal:repeat=</span><span class="s">&quot;variable path_variables_dict&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;dt&gt;</span>${variable}<span class="nt">&lt;/dt&gt;</span>
    <span class="nt">&lt;dd&gt;</span>${python:path_variables_dict[variable]}<span class="nt">&lt;/dd&gt;</span>
  <span class="nt">&lt;/tal:vars&gt;</span>
<span class="nt">&lt;/dl&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>In Plone 4 that used to be <code class="docutils literal"><span class="pre">CONTEXTS</span></code></p>
<div class="last highlight-html"><div class="highlight"><pre><span class="nt">&lt;dl</span> <span class="na">tal:define=</span><span class="s">&quot;path_variables_dict CONTEXTS&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;tal:vars</span> <span class="na">tal:repeat=</span><span class="s">&quot;variable path_variables_dict&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;dt</span> <span class="na">tal:content=</span><span class="s">&quot;variable&quot;</span><span class="nt">&gt;&lt;/dt&gt;</span>
    <span class="nt">&lt;dd</span> <span class="na">tal:content=</span><span class="s">&quot;python:path_variables_dict[variable]&quot;</span><span class="nt">&gt;&lt;/dd&gt;</span>
  <span class="nt">&lt;/tal:vars&gt;</span>
<span class="nt">&lt;/dl&gt;</span>
</pre></div>
</div>
</div>
<p>Useful for debugging :-)</p>
</div>
<div class="section" id="pure-tal-blocks">
<h3>Pure TAL blocks<a class="headerlink" href="#pure-tal-blocks" title="Permalink to this headline">¶</a></h3>
<p>We can use TAL attributes without HTML Tags. This is useful when we don&#8217;t need to add any tags to the markup</p>
<p>Syntax:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;tal:block</span> <span class="na">attribute=</span><span class="s">&quot;expression&quot;</span><span class="nt">&gt;</span>some content<span class="nt">&lt;/tal:block&gt;</span>
</pre></div>
</div>
<p>Examples:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;tal:block</span> <span class="na">define=</span><span class="s">&quot;id template/id&quot;</span><span class="nt">&gt;</span>
...
  <span class="nt">&lt;b</span> <span class="na">tal:content=</span><span class="s">&quot;id&quot;</span><span class="nt">&gt;</span>The id of the template<span class="nt">&lt;/b&gt;</span>
...
<span class="nt">&lt;/tal:block&gt;</span>

<span class="nt">&lt;tal:news</span> <span class="na">condition=</span><span class="s">&quot;python:context.portal_type == &#39;News Item&#39;&quot;</span><span class="nt">&gt;</span>
    This text is only visible if the context is a News Item
<span class="nt">&lt;/tal:news&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="handling-complex-data-in-templates">
<h3>handling complex data in templates<a class="headerlink" href="#handling-complex-data-in-templates" title="Permalink to this headline">¶</a></h3>
<p>Let&#8217;s move on to a little more complex data. And to another TAL attribute:</p>
<dl class="docutils">
<dt>tal:replace</dt>
<dd>replace the content of an element and removes the element only leaving the content.</dd>
</dl>
<p>Example:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;p&gt;</span>
    <span class="nt">&lt;img</span> <span class="na">tal:define=</span><span class="s">&quot;tag string:&lt;img src=&#39;https://plone.org/logo.png&#39;&gt;&quot;</span>
         <span class="na">tal:replace=</span><span class="s">&quot;tag&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;/p&gt;</span>
</pre></div>
</div>
<p>this results in:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;p&gt;</span>
    <span class="ni">&amp;lt;</span>img src=&#39;https://plone.org/logo.png&#39;<span class="ni">&amp;gt;</span>
<span class="nt">&lt;/p&gt;</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">tal:replace</span></code> drops its own base tag in favor of the result of the TALES expression. Thus the original <code class="docutils literal"><span class="pre">&lt;img...</span> <span class="pre">&gt;</span></code> is replaced. But the result is escaped by default.</p>
<p>To prevent escaping we use <code class="docutils literal"><span class="pre">structure</span></code></p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;p&gt;</span>
    <span class="nt">&lt;img</span> <span class="na">tal:define=</span><span class="s">&quot;tag string:&lt;img src=&#39;https://plone.org/logo.png&#39;&gt;&quot;</span>
         <span class="na">tal:replace=</span><span class="s">&quot;structure tag&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;/p&gt;</span>
</pre></div>
</div>
<p>Now let&#8217;s emulate a typical Plone structure by creating a dictionary.</p>
<div class="highlight-html"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre>  <span class="nt">&lt;table</span> <span class="na">tal:define=</span><span class="s">&quot;talks python:[{&#39;title&#39;:&#39;Dexterity for the win!&#39;,</span>
<span class="s">                                    &#39;subjects&#39;:(&#39;content-types&#39;, &#39;dexterity&#39;)},</span>
<span class="s">                                   {&#39;title&#39;:&#39;Deco is the future&#39;,</span>
<span class="s">                                    &#39;subjects&#39;:(&#39;layout&#39;, &#39;deco&#39;)},</span>
<span class="s">                                   {&#39;title&#39;:&#39;The State of Plone&#39;,</span>
<span class="s">                                    &#39;subjects&#39;:(&#39;keynote&#39;,) },</span>
<span class="s">                                   {&#39;title&#39;:&#39;Diazo designs dont suck!&#39;,</span>
<span class="s">                                    &#39;subjects&#39;:(&#39;design&#39;, &#39;diazo&#39;, &#39;xslt&#39;)}</span>
<span class="s">                                  ]&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;tr&gt;</span>
          <span class="nt">&lt;th&gt;</span>Title<span class="nt">&lt;/th&gt;</span>
          <span class="nt">&lt;th&gt;</span>Topics<span class="nt">&lt;/th&gt;</span>
      <span class="nt">&lt;/tr&gt;</span>
      <span class="nt">&lt;tr</span> <span class="na">tal:repeat=</span><span class="s">&quot;talk talks&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;td</span> <span class="na">tal:content=</span><span class="s">&quot;talk/title&quot;</span><span class="nt">&gt;</span>A talk<span class="nt">&lt;/td&gt;</span>
          <span class="nt">&lt;td</span> <span class="na">tal:define=</span><span class="s">&quot;subjects talk/subjects&quot;</span><span class="nt">&gt;</span>
              <span class="nt">&lt;span</span> <span class="na">tal:repeat=</span><span class="s">&quot;subject subjects&quot;</span>
                    <span class="na">tal:replace=</span><span class="s">&quot;subject&quot;</span><span class="nt">&gt;</span>
              <span class="nt">&lt;/span&gt;</span>
          <span class="nt">&lt;/td&gt;</span>
      <span class="nt">&lt;/tr&gt;</span>
  <span class="nt">&lt;/table&gt;</span>
</pre></div>
</td></tr></table></div>
<p>We emulate a list of talks and display information about them in a table. We&#8217;ll get back to the list of talks later when we use the real talk objects that we created with dexterity.</p>
<p>To complete the list here are the TAL attributes we have not yet used:</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">tal:omit-tag</span></code></dt>
<dd>Omit the element tag, leaving only the inner content.</dd>
<dt><code class="docutils literal"><span class="pre">tal:on-error</span></code></dt>
<dd>handle errors.</dd>
</dl>
<p>When an element has multiple TAL attributes, they are executed in this order:</p>
<ol class="arabic simple">
<li>define</li>
<li>condition</li>
<li>repeat</li>
<li>content or replace</li>
<li>attributes</li>
<li>omit-tag</li>
</ol>
</div>
</div>
<div class="section" id="plone-5">
<h2>Plone 5<a class="headerlink" href="#plone-5" title="Permalink to this headline">¶</a></h2>
<p>Plone 5 uses a new rendering engine called <a class="reference external" href="https://chameleon.readthedocs.org/en/latest/">Chameleon</a>. Using the integration layer <a class="reference external" href="https://pypi.python.org/pypi/five.pt">five.pt</a> it is fully compatible with the normal TAL syntax but offers some additional features:</p>
<p>You can use <code class="docutils literal"><span class="pre">${...}</span></code> as short-hand for text insertion in pure html effectively making <code class="docutils literal"><span class="pre">tal:content</span></code> and <code class="docutils literal"><span class="pre">tal:attributes</span></code> obsolete. Here are some examples:</p>
<p>Plone 4 and Plone 5:</p>
<div class="highlight-html"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span class="nt">&lt;a</span> <span class="na">tal:attributes=</span><span class="s">&quot;href string:${context/absolute_url}?ajax_load=1;</span>
<span class="s">                   class python:context.portal_type.lower().replace(&#39; &#39;, &#39;&#39;)&quot;</span>
   <span class="na">tal:content=</span><span class="s">&quot;context/title&quot;</span><span class="nt">&gt;</span>
   The Title of the current object
<span class="nt">&lt;/a&gt;</span>
</pre></div>
</td></tr></table></div>
<p>Plone 5 (and Plone 4 with five.pt) :</p>
<div class="highlight-html"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;${context/absolute_url}?ajax_load=1&quot;</span>
   <span class="na">class=</span><span class="s">&quot;${python:context.portal_type.lower().replace(&#39; &#39;, &#39;&#39;)}&quot;</span><span class="nt">&gt;</span>
   ${python:context.title}
<span class="nt">&lt;/a&gt;</span>
</pre></div>
</td></tr></table></div>
<p>You can also add pure python into the templates:</p>
<div class="highlight-html"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span class="nt">&lt;div&gt;</span>
  <span class="cp">&lt;?python</span>
<span class="cp">  someoptions = dict(</span>
<span class="cp">      id=context.id,</span>
<span class="cp">      title=context.title)</span>
<span class="cp">  ?&gt;</span>
  This object has the id &quot;${python:someoptions[&#39;id&#39;]}&quot;&quot; and the title &quot;${python:someoptions[&#39;title&#39;]}&quot;.
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="exercise-1">
<span id="zpt-metal-label"></span><h2>Exercise 1<a class="headerlink" href="#exercise-1" title="Permalink to this headline">¶</a></h2>
<p>Modify the following template and one by one solve the following problems:
:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;table</span> <span class="na">tal:define=</span><span class="s">&quot;talks python:[{&#39;title&#39;: &#39;Dexterity is the new default!&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;content-types&#39;, &#39;dexterity&#39;)},</span>
<span class="s">                                 {&#39;title&#39;: &#39;Mosaic will be the next big thing.&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;layout&#39;, &#39;deco&#39;, &#39;views&#39;),</span>
<span class="s">                                  &#39;url&#39;: &#39;https://www.youtube.com/watch?v=QSNufxaYb1M&#39;},</span>
<span class="s">                                 {&#39;title&#39;: &#39;The State of Plone&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;keynote&#39;,) },</span>
<span class="s">                                 {&#39;title&#39;: &#39;Diazo is a powerful tool for theming!&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;design&#39;, &#39;diazo&#39;, &#39;xslt&#39;)},</span>
<span class="s">                                 {&#39;title&#39;: &#39;Magic templates in Plone 5&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;templates&#39;, &#39;TAL&#39;),</span>
<span class="s">                                  &#39;url&#39;: &#39;http://www.starzel.de/blog/magic-templates-in-plone-5&#39;}</span>
<span class="s">                                ]&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
        <span class="nt">&lt;th&gt;</span>Title<span class="nt">&lt;/th&gt;</span>
        <span class="nt">&lt;th&gt;</span>Topics<span class="nt">&lt;/th&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;tr</span> <span class="na">tal:repeat=</span><span class="s">&quot;talk talks&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;td</span> <span class="na">tal:content=</span><span class="s">&quot;talk/title&quot;</span><span class="nt">&gt;</span>A talk<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;td</span> <span class="na">tal:define=</span><span class="s">&quot;subjects talk/subjects&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;span</span> <span class="na">tal:repeat=</span><span class="s">&quot;subject subjects&quot;</span>
                  <span class="na">tal:replace=</span><span class="s">&quot;subject&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/span&gt;</span>
        <span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
<span class="nt">&lt;/table&gt;</span>
</pre></div>
</div>
<ol class="arabic simple">
<li>Display the subjects as comma-separated.</li>
</ol>
<div class="toggle admonition">
<p class="first admonition-title">Solution</p>
<div class="last highlight-html"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span class="nt">&lt;table</span> <span class="na">tal:define=</span><span class="s">&quot;talks python:[{&#39;title&#39;: &#39;Dexterity is the new default!&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;content-types&#39;, &#39;dexterity&#39;)},</span>
<span class="s">                                 {&#39;title&#39;: &#39;Mosaic will be the next big thing.&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;layout&#39;, &#39;deco&#39;, &#39;views&#39;),</span>
<span class="s">                                  &#39;url&#39;: &#39;https://www.youtube.com/watch?v=QSNufxaYb1M&#39;},</span>
<span class="s">                                 {&#39;title&#39;: &#39;The State of Plone&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;keynote&#39;,) },</span>
<span class="s">                                 {&#39;title&#39;: &#39;Diazo is a powerful tool for theming!&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;design&#39;, &#39;diazo&#39;, &#39;xslt&#39;)},</span>
<span class="s">                                 {&#39;title&#39;: &#39;Magic templates in Plone 5&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;templates&#39;, &#39;TAL&#39;),</span>
<span class="s">                                  &#39;url&#39;: &#39;http://www.starzel.de/blog/magic-templates-in-plone-5&#39;}</span>
<span class="s">                                ]&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
        <span class="nt">&lt;th&gt;</span>Title<span class="nt">&lt;/th&gt;</span>
        <span class="nt">&lt;th&gt;</span>Topics<span class="nt">&lt;/th&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;tr</span> <span class="na">tal:repeat=</span><span class="s">&quot;talk talks&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;td</span> <span class="na">tal:content=</span><span class="s">&quot;talk/title&quot;</span><span class="nt">&gt;</span>A talk<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;td</span> <span class="na">tal:define=</span><span class="s">&quot;subjects talk/subjects&quot;</span><span class="nt">&gt;</span>
<span class="hll">            <span class="nt">&lt;span</span> <span class="na">tal:replace=</span><span class="s">&quot;python:&#39;, &#39;.join(subjects)&quot;</span><span class="nt">&gt;</span>
</span>            <span class="nt">&lt;/span&gt;</span>
        <span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
<span class="nt">&lt;/table&gt;</span>
</pre></div>
</td></tr></table></div>
</div>
<ol class="arabic simple" start="2">
<li>Turn the title in a link to the url of the talk if there is one.</li>
</ol>
<div class="toggle admonition">
<p class="first admonition-title">Solution</p>
<div class="last highlight-html"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="highlight"><pre><span class="nt">&lt;table</span> <span class="na">tal:define=</span><span class="s">&quot;talks python:[{&#39;title&#39;: &#39;Dexterity is the new default!&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;content-types&#39;, &#39;dexterity&#39;)},</span>
<span class="s">                                 {&#39;title&#39;: &#39;Mosaic will be the next big thing.&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;layout&#39;, &#39;deco&#39;, &#39;views&#39;),</span>
<span class="s">                                  &#39;url&#39;: &#39;https://www.youtube.com/watch?v=QSNufxaYb1M&#39;},</span>
<span class="s">                                 {&#39;title&#39;: &#39;The State of Plone&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;keynote&#39;,) },</span>
<span class="s">                                 {&#39;title&#39;: &#39;Diazo is a powerful tool for theming!&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;design&#39;, &#39;diazo&#39;, &#39;xslt&#39;)},</span>
<span class="s">                                 {&#39;title&#39;: &#39;Magic templates in Plone 5&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;templates&#39;, &#39;TAL&#39;),</span>
<span class="s">                                  &#39;url&#39;: &#39;http://www.starzel.de/blog/magic-templates-in-plone-5&#39;}</span>
<span class="s">                                ]&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
        <span class="nt">&lt;th&gt;</span>Title<span class="nt">&lt;/th&gt;</span>
        <span class="nt">&lt;th&gt;</span>Topics<span class="nt">&lt;/th&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;tr</span> <span class="na">tal:repeat=</span><span class="s">&quot;talk talks&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;td&gt;</span>
<span class="hll">            <span class="nt">&lt;a</span> <span class="na">tal:attributes=</span><span class="s">&quot;href talk/url | nothing&quot;</span>
</span>               <span class="na">tal:content=</span><span class="s">&quot;talk/title&quot;</span><span class="nt">&gt;</span>
               A talk
            <span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;td</span> <span class="na">tal:define=</span><span class="s">&quot;subjects talk/subjects&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;span</span> <span class="na">tal:replace=</span><span class="s">&quot;python:&#39;, &#39;.join(subjects)&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/span&gt;</span>
        <span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
<span class="nt">&lt;/table&gt;</span>
</pre></div>
</td></tr></table></div>
</div>
<ol class="arabic simple" start="3">
<li>If there is no url turn it into a link to a google search for that talk&#8217;s title</li>
</ol>
<div class="toggle admonition">
<p class="first admonition-title">Solution</p>
<div class="last highlight-html"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</pre></div></td><td class="code"><div class="highlight"><pre><span class="nt">&lt;table</span> <span class="na">tal:define=</span><span class="s">&quot;talks python:[{&#39;title&#39;: &#39;Dexterity is the new default!&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;content-types&#39;, &#39;dexterity&#39;)},</span>
<span class="s">                                 {&#39;title&#39;: &#39;Mosaic will be the next big thing.&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;layout&#39;, &#39;deco&#39;, &#39;views&#39;),</span>
<span class="s">                                  &#39;url&#39;: &#39;https://www.youtube.com/watch?v=QSNufxaYb1M&#39;},</span>
<span class="s">                                 {&#39;title&#39;: &#39;The State of Plone&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;keynote&#39;,) },</span>
<span class="s">                                 {&#39;title&#39;: &#39;Diazo is a powerful tool for theming!&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;design&#39;, &#39;diazo&#39;, &#39;xslt&#39;)},</span>
<span class="s">                                 {&#39;title&#39;: &#39;Magic templates in Plone 5&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;templates&#39;, &#39;TAL&#39;),</span>
<span class="s">                                  &#39;url&#39;: &#39;http://www.starzel.de/blog/magic-templates-in-plone-5&#39;}</span>
<span class="s">                                ]&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
        <span class="nt">&lt;th&gt;</span>Title<span class="nt">&lt;/th&gt;</span>
        <span class="nt">&lt;th&gt;</span>Topics<span class="nt">&lt;/th&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;tr</span> <span class="na">tal:repeat=</span><span class="s">&quot;talk talks&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;td&gt;</span>
<span class="hll">            <span class="nt">&lt;a</span> <span class="na">tal:define=</span><span class="s">&quot;google_url string:https://www.google.com/search?q=${talk/title}&quot;</span>
</span><span class="hll">               <span class="na">tal:attributes=</span><span class="s">&quot;href talk/url | google_url&quot;</span>
</span>               <span class="na">tal:content=</span><span class="s">&quot;talk/title&quot;</span><span class="nt">&gt;</span>
               A talk
            <span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;td</span> <span class="na">tal:define=</span><span class="s">&quot;subjects talk/subjects&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;span</span> <span class="na">tal:replace=</span><span class="s">&quot;python:&#39;, &#39;.join(subjects)&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/span&gt;</span>
        <span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
<span class="nt">&lt;/table&gt;</span>
</pre></div>
</td></tr></table></div>
</div>
<ol class="arabic" start="4">
<li><p class="first">Add alternating the css classes &#8216;odd&#8217; and &#8216;even&#8217; to the &lt;tr&gt;. (<code class="docutils literal"><span class="pre">repeat.&lt;name</span> <span class="pre">of</span> <span class="pre">item</span> <span class="pre">in</span> <span class="pre">loop&gt;.odd</span></code> is True if the ordinal index of the current iteration is an odd number)</p>
<p>Use some css to prove your solution:</p>
<div class="highlight-css"><div class="highlight"><pre><span class="o">&lt;</span><span class="nt">style</span> <span class="nt">type</span><span class="o">=</span><span class="s2">&quot;text/css&quot;</span><span class="o">&gt;</span>
  <span class="nt">tr</span><span class="nc">.odd</span> <span class="p">{</span><span class="k">background-color</span><span class="o">:</span> <span class="m">#ddd</span><span class="p">;}</span>
<span class="o">&lt;/</span><span class="nt">style</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
</ol>
<div class="toggle admonition">
<p class="first admonition-title">Solution</p>
<div class="last highlight-html"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></div></td><td class="code"><div class="highlight"><pre><span class="nt">&lt;table</span> <span class="na">tal:define=</span><span class="s">&quot;talks python:[{&#39;title&#39;: &#39;Dexterity is the new default!&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;content-types&#39;, &#39;dexterity&#39;)},</span>
<span class="s">                                 {&#39;title&#39;: &#39;Mosaic will be the next big thing.&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;layout&#39;, &#39;deco&#39;, &#39;views&#39;),</span>
<span class="s">                                  &#39;url&#39;: &#39;https://www.youtube.com/watch?v=QSNufxaYb1M&#39;},</span>
<span class="s">                                 {&#39;title&#39;: &#39;The State of Plone&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;keynote&#39;,) },</span>
<span class="s">                                 {&#39;title&#39;: &#39;Diazo is a powerful tool for theming!&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;design&#39;, &#39;diazo&#39;, &#39;xslt&#39;)},</span>
<span class="s">                                 {&#39;title&#39;: &#39;Magic templates in Plone 5&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;templates&#39;, &#39;TAL&#39;),</span>
<span class="s">                                  &#39;url&#39;: &#39;http://www.starzel.de/blog/magic-templates-in-plone-5&#39;}</span>
<span class="s">                                ]&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
        <span class="nt">&lt;th&gt;</span>Title<span class="nt">&lt;/th&gt;</span>
        <span class="nt">&lt;th&gt;</span>Topics<span class="nt">&lt;/th&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;tr</span> <span class="na">tal:repeat=</span><span class="s">&quot;talk talks&quot;</span>
<span class="hll">        <span class="na">tal:attributes=</span><span class="s">&quot;class python: &#39;odd&#39; if repeat.talk.odd else &#39;even&#39;&quot;</span><span class="nt">&gt;</span>
</span>        <span class="nt">&lt;td&gt;</span>
            <span class="nt">&lt;a</span> <span class="na">tal:define=</span><span class="s">&quot;google_url string:https://www.google.com/search?q=${talk/title};</span>
<span class="s">                           &quot;</span>
               <span class="na">tal:attributes=</span><span class="s">&quot;href talk/url | google_url;</span>
<span class="s">                               &quot;</span>
               <span class="na">tal:content=</span><span class="s">&quot;talk/title&quot;</span><span class="nt">&gt;</span>
               A talk
            <span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;td</span> <span class="na">tal:define=</span><span class="s">&quot;subjects talk/subjects&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;span</span> <span class="na">tal:replace=</span><span class="s">&quot;python:&#39;, &#39;.join(subjects)&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/span&gt;</span>
        <span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
<span class="nt">&lt;/table&gt;</span>
</pre></div>
</td></tr></table></div>
</div>
<ol class="arabic simple" start="5">
<li>Only use python expressions.</li>
</ol>
<div class="toggle admonition">
<p class="first admonition-title">Solution</p>
<div class="last highlight-html"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="highlight"><pre><span class="nt">&lt;table</span> <span class="na">tal:define=</span><span class="s">&quot;talks python:[{&#39;title&#39;: &#39;Dexterity is the new default!&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;content-types&#39;, &#39;dexterity&#39;)},</span>
<span class="s">                                 {&#39;title&#39;: &#39;Mosaic will be the next big thing.&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;layout&#39;, &#39;deco&#39;, &#39;views&#39;),</span>
<span class="s">                                  &#39;url&#39;: &#39;https://www.youtube.com/watch?v=QSNufxaYb1M&#39;},</span>
<span class="s">                                 {&#39;title&#39;: &#39;The State of Plone&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;keynote&#39;,) },</span>
<span class="s">                                 {&#39;title&#39;: &#39;Diazo is a powerful tool for theming!&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;design&#39;, &#39;diazo&#39;, &#39;xslt&#39;)},</span>
<span class="s">                                 {&#39;title&#39;: &#39;Magic templates in Plone 5&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;templates&#39;, &#39;TAL&#39;),</span>
<span class="s">                                  &#39;url&#39;: &#39;http://www.starzel.de/blog/magic-templates-in-plone-5&#39;}</span>
<span class="s">                                ]&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
        <span class="nt">&lt;th&gt;</span>Title<span class="nt">&lt;/th&gt;</span>
        <span class="nt">&lt;th&gt;</span>Topics<span class="nt">&lt;/th&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;tr</span> <span class="na">tal:repeat=</span><span class="s">&quot;talk python:talks&quot;</span>
        <span class="na">tal:attributes=</span><span class="s">&quot;class python: &#39;odd&#39; if repeat.talk.odd else &#39;even&#39;&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;td&gt;</span>
            <span class="nt">&lt;a</span> <span class="na">tal:attributes=</span><span class="s">&quot;href python:talk.get(&#39;url&#39;, &#39;https://www.google.com/search?q=%s&#39; % talk[&#39;title&#39;])&quot;</span>
               <span class="na">tal:content=</span><span class="s">&quot;python:talk[&#39;title&#39;]&quot;</span><span class="nt">&gt;</span>
               A talk
            <span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;td</span> <span class="na">tal:content=</span><span class="s">&quot;python:&#39;, &#39;.join(talk[&#39;subjects&#39;])&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
<span class="nt">&lt;/table&gt;</span>
</pre></div>
</td></tr></table></div>
</div>
<ol class="arabic simple" start="6">
<li>Use the new syntax of Plone 5</li>
</ol>
<div class="toggle admonition">
<p class="first admonition-title">Solution</p>
<div class="last highlight-html"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="highlight"><pre><span class="nt">&lt;table</span> <span class="na">tal:define=</span><span class="s">&quot;talks python:[{&#39;title&#39;: &#39;Dexterity is the new default!&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;content-types&#39;, &#39;dexterity&#39;)},</span>
<span class="s">                                 {&#39;title&#39;: &#39;Mosaic will be the next big thing.&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;layout&#39;, &#39;deco&#39;, &#39;views&#39;),</span>
<span class="s">                                  &#39;url&#39;: &#39;https://www.youtube.com/watch?v=QSNufxaYb1M&#39;},</span>
<span class="s">                                 {&#39;title&#39;: &#39;The State of Plone&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;keynote&#39;,) },</span>
<span class="s">                                 {&#39;title&#39;: &#39;Diazo is a powerful tool for theming!&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;design&#39;, &#39;diazo&#39;, &#39;xslt&#39;)},</span>
<span class="s">                                 {&#39;title&#39;: &#39;Magic templates in Plone 5&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;templates&#39;, &#39;TAL&#39;),</span>
<span class="s">                                  &#39;url&#39;: &#39;http://www.starzel.de/blog/magic-templates-in-plone-5&#39;}</span>
<span class="s">                                ]&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
        <span class="nt">&lt;th&gt;</span>Title<span class="nt">&lt;/th&gt;</span>
        <span class="nt">&lt;th&gt;</span>Topics<span class="nt">&lt;/th&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>

    <span class="nt">&lt;tr</span> <span class="na">tal:repeat=</span><span class="s">&quot;talk python:talks&quot;</span>
<span class="hll">        <span class="na">class=</span><span class="s">&quot;${python: &#39;odd&#39; if repeat.talk.odd else &#39;even&#39;}&quot;</span><span class="nt">&gt;</span>
</span>        <span class="nt">&lt;td&gt;</span>
            <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;${python:talk.get(&#39;url&#39;, &#39;https://www.google.com/search?q=%s&#39; % talk[&#39;title&#39;])}&quot;</span><span class="nt">&gt;</span>
                ${talk_title}
<span class="hll">            <span class="nt">&lt;/a&gt;</span>
</span>        <span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;td&gt;</span>
            ${python:&#39;, &#39;.join(talk[&#39;subjects&#39;])}
<span class="hll">        <span class="nt">&lt;/td&gt;</span>
</span>    <span class="nt">&lt;/tr&gt;</span>
<span class="nt">&lt;/table&gt;</span>
</pre></div>
</td></tr></table></div>
</div>
<ol class="arabic simple" start="7">
<li>Sort the talks alphabetically by title</li>
</ol>
<div class="toggle admonition">
<p class="first admonition-title">Solution</p>
<div class="last highlight-html"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></div></td><td class="code"><div class="highlight"><pre><span class="nt">&lt;table</span> <span class="na">tal:define=</span><span class="s">&quot;talks python:[{&#39;title&#39;: &#39;Dexterity is the new default!&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;content-types&#39;, &#39;dexterity&#39;)},</span>
<span class="s">                                 {&#39;title&#39;: &#39;Mosaic will be the next big thing.&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;layout&#39;, &#39;deco&#39;, &#39;views&#39;),</span>
<span class="s">                                  &#39;url&#39;: &#39;https://www.youtube.com/watch?v=QSNufxaYb1M&#39;},</span>
<span class="s">                                 {&#39;title&#39;: &#39;The State of Plone&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;keynote&#39;,) },</span>
<span class="s">                                 {&#39;title&#39;: &#39;Diazo is a powerful tool for theming!&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;design&#39;, &#39;diazo&#39;, &#39;xslt&#39;)},</span>
<span class="s">                                 {&#39;title&#39;: &#39;Magic templates in Plone 5&#39;,</span>
<span class="s">                                  &#39;subjects&#39;: (&#39;templates&#39;, &#39;TAL&#39;),</span>
<span class="s">                                  &#39;url&#39;: &#39;http://www.starzel.de/blog/magic-templates-in-plone-5&#39;}</span>
<span class="s">                                ]&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
        <span class="nt">&lt;th&gt;</span>Title<span class="nt">&lt;/th&gt;</span>
        <span class="nt">&lt;th&gt;</span>Topics<span class="nt">&lt;/th&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>

<span class="hll"><span class="cp">&lt;?python from operator import itemgetter ?&gt;</span>
</span>
<span class="hll">    <span class="nt">&lt;tr</span> <span class="na">tal:repeat=</span><span class="s">&quot;talk python:sorted(talks, key=itemgetter(&#39;title&#39;))&quot;</span>
</span>        <span class="na">class=</span><span class="s">&quot;${python: &#39;odd&#39; if repeat.talk.odd else &#39;even&#39;}&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;td&gt;</span>
            <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;${python:talk.get(&#39;url&#39;, &#39;https://www.google.com/search?q=%s&#39; % talk[&#39;title&#39;])}&quot;</span><span class="nt">&gt;</span>
                ${talk_title}
            <span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;td&gt;</span>
            ${python:&#39;, &#39;.join(talk[&#39;subjects&#39;])}
        <span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
<span class="nt">&lt;/table&gt;</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="metal-and-macros">
<h2>METAL and macros<a class="headerlink" href="#metal-and-macros" title="Permalink to this headline">¶</a></h2>
<p>Why is our output so ugly? How do we get our html to render in Plone the UI?</p>
<p>We use METAL (Macro Extension to TAL) to define slots that we can fill and macros that we can reuse.</p>
<p>We add to the <code class="docutils literal"><span class="pre">&lt;html&gt;</span></code> tag:</p>
<div class="highlight-python"><div class="highlight"><pre>metal:use-macro=&quot;context/main_template/macros/master&quot;
</pre></div>
</div>
<p>And then wrap the code we want to put in the content area of Plone in:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;metal:content-core</span> <span class="na">fill-slot=</span><span class="s">&quot;content-core&quot;</span><span class="nt">&gt;</span>
    ...
<span class="nt">&lt;/metal:content-core&gt;</span>
</pre></div>
</div>
<p>This will put our code in a section defined in the main_template called &#8220;content-core&#8221;.</p>
<p>The template should now look like this:</p>
<div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35</pre></div></td><td class="code"><div class="highlight"><pre><span class="nt">&lt;html</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/1999/xhtml&quot;</span> <span class="na">xml:lang=</span><span class="s">&quot;en&quot;</span>
      <span class="na">lang=</span><span class="s">&quot;en&quot;</span>
      <span class="na">metal:use-macro=</span><span class="s">&quot;context/main_template/macros/master&quot;</span>
      <span class="na">i18n:domain=</span><span class="s">&quot;ploneconf.site&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;body&gt;</span>

<span class="nt">&lt;metal:content-core</span> <span class="na">fill-slot=</span><span class="s">&quot;content-core&quot;</span><span class="nt">&gt;</span>

<span class="nt">&lt;table</span> <span class="na">tal:define=</span><span class="s">&quot;talks python:[{&#39;title&#39;:&#39;Dexterity for the win!&#39;,</span>
<span class="s">                                  &#39;subjects&#39;:(&#39;content-types&#39;, &#39;dexterity&#39;)},</span>
<span class="s">                                 {&#39;title&#39;:&#39;Deco is the future&#39;,</span>
<span class="s">                                  &#39;subjects&#39;:(&#39;layout&#39;, &#39;deco&#39;)},</span>
<span class="s">                                 {&#39;title&#39;:&#39;The State of Plone&#39;,</span>
<span class="s">                                  &#39;subjects&#39;:(&#39;keynote&#39;,) },</span>
<span class="s">                                 {&#39;title&#39;:&#39;Diazo designs are great&#39;,</span>
<span class="s">                                  &#39;subjects&#39;:(&#39;design&#39;, &#39;diazo&#39;, &#39;xslt&#39;)}</span>
<span class="s">                                ]&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
        <span class="nt">&lt;th&gt;</span>Title<span class="nt">&lt;/th&gt;</span>
        <span class="nt">&lt;th&gt;</span>Topics<span class="nt">&lt;/th&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;tr</span> <span class="na">tal:repeat=</span><span class="s">&quot;talk talks&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;td</span> <span class="na">tal:content=</span><span class="s">&quot;talk/title&quot;</span><span class="nt">&gt;</span>A talk<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;td</span> <span class="na">tal:define=</span><span class="s">&quot;subjects talk/subjects&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;span</span> <span class="na">tal:repeat=</span><span class="s">&quot;subject subjects&quot;</span>
                  <span class="na">tal:replace=</span><span class="s">&quot;subject&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/span&gt;</span>
        <span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
<span class="nt">&lt;/table&gt;</span>

<span class="nt">&lt;/metal:content-core&gt;</span>

<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Since the training only used content from the template, not from the context that it is called on it makes little sense to have the edit bar. We hide it by setting the respective variable on the current request with python to 1: <code class="docutils literal"><span class="pre">request.set('disable_border',</span> <span class="pre">1)</span></code>.</p>
<p>The easiest way to do this is to define a dummy variable. Dummy because it is never used except to allow us to execute some code.</p>
<div class="last highlight-xml"><div class="highlight"><pre><span class="nt">&lt;metal:block</span> <span class="na">fill-slot=</span><span class="s">&quot;top_slot&quot;</span>
    <span class="na">tal:define=</span><span class="s">&quot;dummy python:request.set(&#39;disable_border&#39;, 1)&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="macros-in-browser-views">
<h3>macros in browser views<a class="headerlink" href="#macros-in-browser-views" title="Permalink to this headline">¶</a></h3>
<p>Define a macro in a new file <code class="docutils literal"><span class="pre">macros.pt</span></code></p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">metal:define-macro=</span><span class="s">&quot;my_macro&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;p&gt;</span>I can be reused<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<p>Register it as a simple BrowserView in zcml:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;browser:page</span>
  <span class="na">for=</span><span class="s">&quot;*&quot;</span>
  <span class="na">name=</span><span class="s">&quot;abunchofmacros&quot;</span>
  <span class="na">template=</span><span class="s">&quot;templates/macros.pt&quot;</span>
  <span class="na">permission=</span><span class="s">&quot;zope2.View&quot;</span>
  <span class="nt">/&gt;</span>
</pre></div>
</div>
<p>Reuse the macro in the template <code class="docutils literal"><span class="pre">training.pt</span></code>:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">metal:use-macro=</span><span class="s">&quot;context/@@abunchofmacros/my_macro&quot;</span><span class="nt">&gt;</span>
    Instead of this the content of the macro will appear...
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<p>Which is the same as:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">metal:use-macro=</span><span class="s">&quot;python:context.restrictedTraverse(&#39;abunchofmacros&#39;)[&#39;my_macro&#39;]&quot;</span><span class="nt">&gt;</span>
    Instead of this the content of the macro will appear...
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<p>Restart your Plone instance from the command line, and then open <a class="reference external" href="http://localhost:8080/Plone/&#64;&#64;training">http://localhost:8080/Plone/&#64;&#64;training</a> to see this macro being used in our &#64;&#64;training browser view template.</p>
</div>
</div>
<div class="section" id="accessing-plone-from-the-template">
<span id="tal-access-plone-label"></span><h2>Accessing Plone from the template<a class="headerlink" href="#accessing-plone-from-the-template" title="Permalink to this headline">¶</a></h2>
<p>In our template we have access to the context object on which the view is called on, the browser view itself (i.e. all python methods we&#8217;ll put in the view later on), the request and response objects and with these we can get almost anything.</p>
<p>In templates we can also access other browser views. Some of those exist to provide easy access to methods we often need:</p>
<div class="highlight-python"><div class="highlight"><pre>tal:define=&quot;context_state context/@@plone_context_state;
            portal_state context/@@plone_portal_state;
            plone_tools context/@@plone_tools;
            plone_view context/@@plone;&quot;
</pre></div>
</div>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">&#64;&#64;plone_context_state</span></code></dt>
<dd>The BrowserView <code class="docutils literal"><span class="pre">plone.app.layout.globals.context.ContextState</span></code> holds useful methods having to do with the current context object such as <code class="docutils literal"><span class="pre">is_default_page</span></code></dd>
<dt><code class="docutils literal"><span class="pre">&#64;&#64;plone_portal_state</span></code></dt>
<dd>The BrowserView <code class="docutils literal"><span class="pre">plone.app.layout.globals.portal.PortalState</span></code> holds methods for the portal like <code class="docutils literal"><span class="pre">portal_url</span></code></dd>
<dt><code class="docutils literal"><span class="pre">&#64;&#64;plone_tools</span></code></dt>
<dd>The BrowserView <code class="docutils literal"><span class="pre">plone.app.layout.globals.tools.Tools</span></code> gives access to the most important tools like <code class="docutils literal"><span class="pre">plone_tools/catalog</span></code></dd>
</dl>
<p>These are very widely used and there are many more.</p>
</div>
<div class="section" id="what-we-missed">
<span id="tal-missing-label"></span><h2>What we missed<a class="headerlink" href="#what-we-missed" title="Permalink to this headline">¶</a></h2>
<p>There are some things we did not cover so far:</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">tal:condition=&quot;exists:expression&quot;</span></code></dt>
<dd>checks if an object or an attribute exists (seldom used)</dd>
<dt><code class="docutils literal"><span class="pre">tal:condition=&quot;nocall:context&quot;</span></code></dt>
<dd>to explicitly not call a callable.</dd>
</dl>
<p>If we refer to content objects, without using the nocall: modifier these objects are unnecessarily rendered in memory as the expression is evaluated.</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">i18n:translate</span></code> and <code class="docutils literal"><span class="pre">i18n:domain</span></code></dt>
<dd>the strings we put in templates can be translated automatically.</dd>
</dl>
<p>There is a lot more about TAL, TALES and METAL that we have not covered. You&#8217;ll only learn it if you keep reading, writing and customizing templates.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference external" href="http://docs.plone.org/adapt-and-extend/theming/templates_css/template_basics.html">http://docs.plone.org/adapt-and-extend/theming/templates_css/template_basics.html</a></li>
<li>Using Zope Page Templates: <a class="reference external" href="http://docs.zope.org/zope2/zope2book/ZPT.html">http://docs.zope.org/zope2/zope2book/ZPT.html</a></li>
<li>Zope Page Templates Reference: <a class="reference external" href="http://docs.zope.org/zope2/zope2book/AppendixC.html">http://docs.zope.org/zope2/zope2book/AppendixC.html</a></li>
</ul>
</div>
</div>
<div class="section" id="tal-chameleon-label">
<span id="id1"></span><h2>Chameleon<a class="headerlink" href="#tal-chameleon-label" title="Permalink to this headline">¶</a></h2>
<p>Chameleon is the successor of Zope Page Templates, it is used in Plone 5.</p>
<ul class="simple">
<li>Plip for Chameleon: <a class="reference external" href="https://dev.plone.org/ticket/12198">https://dev.plone.org/ticket/12198</a></li>
<li>Homepage: <a class="reference external" href="https://chameleon.readthedocs.org/en/latest/">https://chameleon.readthedocs.org/en/latest/</a></li>
</ul>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="zpt_2.html" class="btn btn-neutral float-right" title="18. Customizing Existing Templates" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="views_1.html" class="btn btn-neutral" title="16. Views I" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The text and illustrations in this website are licensed by the Plone Foundation under a Creative Commons Attribution 4.0 International license..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.2.5a',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .admonition-title").show();
        $(".toggle .admonition-title").click(function() {
            $(this).parent().children().not(".admonition-title").toggle(400);
            $(this).parent().children(".admonition-title").toggleClass("open");
        })
    });
</script>


</body>
</html>